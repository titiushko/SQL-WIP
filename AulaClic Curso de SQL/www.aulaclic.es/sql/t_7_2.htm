
<html>

<!-- Mirrored from www.aulaclic.es/sql/t_7_2.htm by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 10 Jun 2011 06:49:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1"><!-- /Added by HTTrack -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name="keywords" content="SQL Base datos access access2000 tutorial manual gratis office enseñanza educacion ddl dcl dml">
<LINK REL=STYLESHEET TYPE="text/css" HREF="estilo_sinf_osc.css" TITLE="estilo_sinf_osc">
<title>Tema 7  Referencias cruzadas</title>
<SCRIPT language=JavaScript>
<!--
var previous = "t_7_1.htm";
var next = "t_8_1.htm";
//-->
</SCRIPT>
</head><body>
<script type='text/javascript' src='../js/sqlmenu_osc.js'></script> 
<script type='text/javascript' src='../js/menu8_com.js'></script> 

<table width="900" border="0">
  <tr>
    <td width="144"><a href="http://www.aulaclic.es/index.html"><img src="comunes/logo_ac1_50.gif" alt="P&aacute;gina inicial"  border="0" longdesc="P%e1gina%20inicial.html"></a></td>
    <td width="505">&nbsp;</td>
	    <td width="234">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 234;
google_ad_height = 60;
google_ad_format = "234x60_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "FAF1E3";
google_color_bg = "FAF1E3";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">

</script>
    </td>
        </tr>
</table>

<br />

<!--   table de "980" ----------------------------------------------->

<table  border="0"> 
  <tr> 
<td >  </td>
<td  > </td>
  </tr>
  <tr> 
<td > 
<!--   td width="770" ------------------ texto pagina ------------------------------>
<TABLE width="100%" border="0" cellpadding="0">
  <TR>
    <TD><p class=tit-1 > <font color="#800000"><B>Tema 7. Tablas de referencias 
      cruzadas </B> (II) </font></p></TD>
    <td><!-- Search Google -->
        <center>
          <form method="get" action="http://www.google.es/custom" target="google_window">
            <table bgcolor="#ffffff">
              <tr>
                <td nowrap="nowrap" valign="top" align="left" height="32"><a href="http://www.google.com/"> <img src="../../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></a>
                    <input type="text" name="q" size="20" maxlength="255" value="">
                    <input type="submit" name="sa" value="B&uacute;squeda">
                    <input type="hidden" name="client" value="pub-1875034419890743">
                    <input type="hidden" name="forid" value="1">
                    <input type="hidden" name="ie" value="ISO-8859-1">
                    <input type="hidden" name="oe" value="ISO-8859-1">
                    <input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFF6EC;LBGC:FFF6EC;ALC:000000;LC:000000;T:0000FF;GFNT:0000FF;GIMP:0000FF;LH:50;LW:141;L:http://www.aulaclic.es/logo_ac1_50.jpg;S:http://www.aulaclic.es/;FORID:1;">
                    <input type="hidden" name="hl" value="es">
                </td>
              </tr>
            </table>
          </form>
        </center>
      <!-- Search Google -->
    </td>
  </TR>
</TABLE>
<BR>
<TABLE width="65%" border="0">
  <TR> 
    <TD width="50%"> 
      <P class=tit-2 > <FONT color="#800000"><B> Las columnas din&aacute;micas</B> 
        </FONT></P>
    </TD>
  </TR>
</TABLE>
<BR>
<TABLE width="100%" border="0" cellpadding="0">
  <TR> 
    <TD class="Normal"> 
      <P class=padding-1> Como hemos dicho las columnas din&aacute;micas son las 
        que se generan seg&uacute;n los valores almacenados en la columna pivote 
        (la que aparece en la cl&aacute;usula <b><font color="#008000"> PIVOT</font></b >), 
     normalmente se genera una columna din&aacute;mica por cada 
        valor que se encuentre en la columna pivote del origen de datos.</P>
      <P class=padding-1>Cuando los posibles valores que puede tomar la columna 
        pivote son conocidos y queremos definir cuales queremos que aparezcan, 
        s&oacute;lo unos cuantos porque no nos interesan algunos o todos incluso 
        si no generan resultado, en este caso usaremos la cl&aacute;usula <b><font color="#008000">IN</font></b>, 
        en la cl&aacute;usula <b><font color="#008000">IN</font></b> se ponen 
        entre par&eacute;ntesis todos los posibles valores, o por lo menos los 
        que queremos que aparezcan en el resultado.</P>
      <P class=padding-1>Por ejemplo s&oacute;lo nos interesan los meses de febrero, 
        mayo y diciembre:</P>
      <P class=padding-1>&nbsp;</P>
      </TD>
  </TR>
</TABLE>
<table width="100%" border="0">
  <tr>
    <td valign = "top"> 
      <P class=padding-sin><font color="#008000"><b>TRANSFORM Sum(importe)<br>
        SELECT rep as empleado<br>
        FROM pedidos<br>
        GROUP BY rep<br>
        PIVOT month(fechapedido) IN (2,5,12);</b></font></p>
    </td>
    <td><img src="graficos/ej_cruzada_solo.gif" width="210" height="162"></td>
  </tr>
</table>
<table width="100%" border="0" cellpadding="0">
  <tr> 
    <td class="Normal"> 
      <p class=padding-1>Si no utilizamos la cl&aacute;usula <b><font color="#008000">IN</font></b>, 
        los meses de mayo y septiembre no aparecen ya que no hay pedidos realizados 
        durante estos meses, si utilizamos la cl&aacute;usula <b><font color="#008000">IN</font></b> 
        y definimos los doces valores posibles, s&iacute; aparecen las columnas 
        correspondientes a estos meses y observamos que ning&uacute;n empleado 
        tiene ventas en esos mes.</p>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td valign="top"> 
      <p class=padding-sin><font color="#008000"><b>TRANSFORM Sum(importe)<br>
        SELECT rep as empleado<br>
        FROM pedidos<br>
        GROUP BY rep<br>
        PIVOT month(fechapedido) IN (1,2,3,4,5,6,7,8,9,10,11,12);</b></font></p>
    </td>
    <td><img src="graficos/ej_cruzada_todos.gif" width="558" height="162"></td>
  </tr>
</table>
<table width="100%" border="0" cellpadding="0">
  <tr> 
    <td class="Normal"> 
      <p class=padding-1>La cl&aacute;usula <b><font color="#008000">IN</font></b> 
        tambi&eacute;n sirve para cambiar el orden de aparici&oacute;n de las 
        columnas din&aacute;micas, las columnas aparecen en el mismo orden en 
        que aparecen en la cl&aacute;usula <b><font color="#008000">IN.</font></b></p>
      </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td valign="top"> 
      <p class=padding-sin><font color="#008000"><b>TRANSFORM Sum(importe)<br>
        SELECT rep as empleado<br>
        FROM pedidos<br>
        GROUP BY rep<br>
        PIVOT month(fechapedido) IN (10,11,12,1,2,3,4,5,6,7,8,9);</b></font></p>
    </td>
    <td><img src="graficos/ej_cruzada_orden.gif" width="554" height="163"></td>
  </tr>
</table>
<table width="65%" border="0">
  <tr> 
    <td width="50%"> 
      <p class=tit-2 > <font color="#800000"><b> <a name="columnas"></a>Las columnas 
        fijas</b></font></p>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr>
    <td> 
      <P class=padding-1>Las columnas fijas son las que aparecen delante de las 
        columnas din&aacute;micas y son fijas porque se genera una sola columna 
        en el resultado por cada columna hayamos indicado en la lista de columnas 
        fijas. Las columnas fijas se indican en la lista de selecci&oacute;n de 
        la sentencia SELECT, una columna fija que siempre debemos incluir es la 
        que sirve de encabezado de fila para que podamos saber cada fila a qu&eacute; 
        valor de encabezado de fila corresponde. Pero adem&aacute;s podemos incluir 
        otras columnas por ejemplo columnas de resumen de cada fila, sin que se 
        tenga en cuenta la agrupaci&oacute;n por la columna pivote. </P>
      <P class=padding-1>Por ejemplo queremos saber para cada empleado cu&aacute;nto 
        ha vendido en total y cu&aacute;l ha sido el importe mayor vendido en 
        un pedido.</P>
      </td>
    
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td valign="top"> 
      <p class=padding-sin><font color="#008000"><b>TRANSFORM Sum(importe) AS 
        Suma<br>
        SELECT rep AS empleado, SUM(importe) AS [Total vendido],MAX(importe) AS 
        mayor<br>
        FROM pedidos<br>
        GROUP BY rep<br>
        PIVOT month(fechapedido) ;</b></font></p>
    </td>
    <td><img src="graficos/ej_cruzada_fijas.gif" width="577" height="162"></td>
  </tr>
</table>
<table width="65%" border="0">
  <tr> 
    <td width="50%"> 
      <p class=tit-2 > <font color="#800000"><b> <a name="resumen"></a>Resumen 
        del tema</b></font></p>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td> 
      <p class=padding-1>La instrucci&oacute;n <b><font color="#008000">TRANSFORM</font></b> 
        se utiliza <b><font color="#000080">para definir una consulta de referencias 
        cruzadas</font></b>.</p>
      <p class=padding-1>Permite presentar los resultados de una sumaria en una 
        tabla de doble entrada como la que se presenta a continuaci&oacute;n:</p>
      <p class=padding-1>&nbsp;</p>
      <p class=padding-1><img src="graficos/resumen_cruzada_trans.gif" width="661" height="253"><br>
      </p>
    </td>
  </tr>
</table>
<table width="100%" border="0" cellpadding="0">
  <tr> 
    <td > 
      <p class=padding-1><a name="ej1"></a><img src="comunes/redBall2-2.gif" width="14" height="14" ><a href="epr_7_1.htm">Ejercicios 
        propuestos</a><br>
      </p>
    </td>
    <td > 
      <p class=padding-1><br>
      </p>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td> <div align="center"> 
        <script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="5259272651";
google_page_url = document.location;
google_color_border = "FDE8D0";
google_color_bg = "FFF6EC";
google_color_link = "663300";
google_color_url = "CC0000";
google_color_text = "000000";
//--></script>
        <script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
      </div></td>
  </tr>
</table>

<BR>
<TABLE width="100%" border="0">
  <TR> 
    <TD width="37%">&nbsp;</TD>
     
    <TD width="6%"><A href="t_7_1.htm"><IMG name="image8" src="comunes/flecha_re.gif" width="22" height="22" border="0"></A></TD>
     
    <TD width="6%"><A href="index.htm"><IMG name="image8" src="comunes/flecha_home.gif" width="22" height="22" border="0"></A></TD>
		
    <TD width="6%"><A href="t_8_1.htm"><IMG name="image2" src="comunes/flecha_av.gif" width="22" height="22" border="0"></A></TD>
    <TD width="45%"> 
      <DIV align="right">Pag.7.2</DIV>
    </TD>
  </TR>
</TABLE>
<table width="100%" border="0">
  <tr> 
    <td> 
      <div align="center"><font size="-1">Aviso legal: este curso es gratuito 
        siempre que se visualice desde la p&aacute;gina web de aulaClic. No est&aacute; 
        permitido descargar el curso ni utilizarlo en academias o centros de ense&ntilde;anza 
        privados sin estar conectado a Internet. </font></div>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td> 
      <div align="center"><font size="-1">© aulaClic. Todos los derechos reservados. 
 <a href="http://www.teacherclick.com/" style="text-decoration: none; color: black;" target="_blank">Free Computer tutorials</a> . 
        Prohibida la reproducci&oacute;n por cualquier medio.<br>
        </font><font size="2">Julio-2001.aulaClic.com</font></div>
    </td>
  </tr>
</table>
<p style='text-align:justify'>&nbsp;</p>
<!--  fin td width="770" --------------- fin texto pagina -------------------------------->

    </td>
    <td  valign="top">
	<!--   td width="160" -------------- anuncios lateral derecho ---------------------------------->
<table  border="0">

  <tr> 
    <td valign="bottom" height="700"> 
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel ="2175968397";
google_color_border = "FFF6EC";
google_color_bg = "FFF6EC";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
    </td>
	
  </tr>
  
  <tr> 
    <td height="150">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 125;
google_ad_height = 125;
google_ad_format = "125x125_as_rimg";
google_cpa_choice = "CAAQmImJlAIaCN5uB6wtFhbmKNyMs4MB";
google_ad_channel = "6146562423";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
    </td>
  </tr>

  <tr> 
    <td height="150">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 160;
google_ad_height = 90;
google_ad_format = "160x90_0ads_al";
google_ad_channel ="2175968397";
google_color_border = "FAF1E3";
google_color_bg = "FAF1E3";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>    </td>
  </tr>
</table>

	<!--   td width="160" ----------- fin anuncios lateral derecho -------------------------------------->

 </td>
 </tr>
<!--   table de "980" ----------------------------------------------->
</table>

</body>


<!-- Mirrored from www.aulaclic.es/sql/t_7_2.htm by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 10 Jun 2011 06:49:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1"><!-- /Added by HTTrack -->
</html>
