
<html>

<!-- Mirrored from www.aulaclic.es/sql/t_6_1.htm by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 10 Jun 2011 06:48:58 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1"><!-- /Added by HTTrack -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name="keywords" content="SQL Base datos access access2000 tutorial manual gratis office enseñanza educacion ddl dcl dml">
<LINK REL=STYLESHEET TYPE="text/css" HREF="estilo_sinf_osc.css" TITLE="estilo_sinf_osc">
<title>Tema 6  Actualizaci&oacute;n de datos</title>
<SCRIPT language=JavaScript>
<!--
var previous = "t_5_2.htm";
var next = "t_6_2.htm";
//-->
</SCRIPT>
</head><body>

<script type='text/javascript' src='../js/sqlmenu_osc.js'></script> 
<script type='text/javascript' src='../js/menu8_com.js'></script> 

<table width="900" border="0">
  <tr>
    <td width="144"><a href="http://www.aulaclic.es/index.html"><img src="comunes/logo_ac1_50.gif" alt="P&aacute;gina inicial"  border="0" longdesc="P%e1gina%20inicial.html"></a></td>
    <td width="505">&nbsp;</td>
	    <td width="234">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 234;
google_ad_height = 60;
google_ad_format = "234x60_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "FAF1E3";
google_color_bg = "FAF1E3";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">

</script>
    </td>
        </tr>
</table>

<br />
<!--   table de "980" ----------------------------------------------->

<table  border="0"> 
  <tr> 
<td >  </td>
<td  > </td>
  </tr>
  <tr> 
<td > 
<!--   td width="770" ------------------ texto pagina ------------------------------>
<TABLE width="100%" border="0" cellpadding="0">
  <TR>
    <TD><p class=tit-1 > <font color="#800000"><B>Tema 6. Actualizaci&oacute;n de 
        datos </B> (I) </font></p></TD>
    <td><!-- Search Google -->
        <center>
          <form method="get" action="http://www.google.es/custom" target="google_window">
            <table bgcolor="#ffffff">
              <tr>
                <td nowrap="nowrap" valign="top" align="left" height="32"><a href="http://www.google.com/"> <img src="../../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></a>
                    <input type="text" name="q" size="20" maxlength="255" value="">
                    <input type="submit" name="sa" value="B&uacute;squeda">
                    <input type="hidden" name="client" value="pub-1875034419890743">
                    <input type="hidden" name="forid" value="1">
                    <input type="hidden" name="ie" value="ISO-8859-1">
                    <input type="hidden" name="oe" value="ISO-8859-1">
                    <input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFF6EC;LBGC:FFF6EC;ALC:000000;LC:000000;T:0000FF;GFNT:0000FF;GIMP:0000FF;LH:50;LW:141;L:http://www.aulaclic.es/logo_ac1_50.jpg;S:http://www.aulaclic.es/;FORID:1;">
                    <input type="hidden" name="hl" value="es">
                </td>
              </tr>
            </table>
          </form>
        </center>
      <!-- Search Google -->
    </td>
  </TR>
</TABLE>
<BR>
<TABLE width="65%" border="0">
  <TR> 
    <TD width="50%"> 
      <P class=tit-2 > <FONT color="#800000"><B> Introducci&oacute;n</B> </FONT></P>
    </TD>
  </TR>
</TABLE>
<BR>
<TABLE width="100%" border="0" cellpadding="0">
  <TR> 
    <TD class="Normal"> 
      <P class=padding-1>Hasta ahora hemos estudiado el c&oacute;mo recuperar 
        datos almacenados en las tablas de nuestra base de datos. En este tema 
        vamos a tratar el de la <b><font color="#000080">actualizaci&oacute;n</font></b> 
        de esos datos, es decir <b><font color="#000080">insertar nuevas filas, 
        borrar filas o cambiar el contenido de las filas de una tabla.</font></b> 
        Estas operaciones <b><font color="#000080">modifican los datos almacenados 
        en las tablas pero no su estructura</font></b>, ni su definici&oacute;n.</P>
      <P class=padding-1>Empezaremos por ver c&oacute;mo <b><font color="#000080">insertar 
        </font></b>nuevas filas (con la sentencia <b><font color="#008000">INSERT 
        INTO</font></b>), veremos una variante (la sentencia <b><font color="#008000">SELECT... 
        INTO</font></b>), despu&eacute;s veremos c&oacute;mo <b><font color="#000080">borrar</font></b> 
        filas de una tabla (con la sentencia <b><font color="#008000">DELETE</font></b>) 
        y por &uacute;ltimo c&oacute;mo <b><font color="#000080">modificar</font></b> 
        el contenido de las filas de una tabla (con la sentencia <b><font color="#008000">UPDATE</font></b>). 
        Si trabajamos en un <b><font color="#000080">entorno multiusuario</font></b>, 
        todas estas operaciones se podr&aacute;n realizar <b><font color="#000080">siempre 
        que tengamos los permisos correspondientes</font></b>.<br>
        <br>
      </P>
      </TD>
  </TR>
</TABLE>
<table width="65%" border="0">
  <tr> 
    <td width="50%"> 
      <p class=tit-2 > <font color="#800000"><b> <a name="insertar"></a>Insertar 
        una fila INSERT INTO...VALUES</b> </font></p>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr>
    <td> 
      <P class=padding-1>La inserci&oacute;n de nuevos datos en una tabla se realiza<b><font color="#000080"> 
        a&ntilde;adiendo filas enteras a la tabla</font></b>, la sentencia SQL 
        que lo permite es la orden <b><font color="#008000">INSERT INTO</font></b>.</P>
      <P class=padding-1> La inserci&oacute;n se puede realizar de una fila o 
        de varias filas de golpe, veremos las dos opciones por separado y empezaremos 
        por la <b><font color="#000080">inserci&oacute;n de una fila.</font></b></P>
      <P class=padding-1>La sintaxis es la siguiente:<br>
      </P>
      </td>
    
  </tr>
</table>
<table width="100%" border="0">
  <tr>
    <td><img src="graficos/insert_values.gif" width="445" height="60"></td>
  </tr>
</table>
<table width="100%" border="0">
  <tr>
    <td>
      <P class=padding-1>Esta sintaxis se utiliza para insertar una sola fila 
        cuyos valores indicamos despu&eacute;s de la palabra reservada <b><font color="#008000">VALUES</font></b>. 
        En castellano la sentencia se leer&iacute;a: <b><font color="#000080">INSERTA 
        EN destino...VALORES ....</font></b></p>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Los registros <b><font color="#000080">se agregan</font></b> siempre <b><font color="#000080">al 
        final de la tabla</font></b>.</p>
      <P class=padding-1><font color="#000080"><b><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Destino</b></font> es el nombre de la <b><font color="#000080">tabla donde 
        vamos a insertar la fila</font></b> tambi&eacute;n se puede utilizar un 
        <b><font color="#000080">nombre de consulta</font></b>, consulta que tenga 
        como origen de datos una<b><font color="#000080"> &uacute;nica tabla</font></b>. 
        Al nombre de la tabla se le puede a&ntilde;adir la cl&aacute;usula <b><font color="#008000">IN</font></b> 
        si la tabla se encuentra en otra base de datos (en una base de datos externa).</p>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        La palabra reservada <b><font color="#008000">VALUES</font></b> se puede 
        sustituir por la palabra <b><font color="#008000">SELECT</font></b> ( 
        en otros SQLs se emplea &uacute;nicamente <b><font color="#008000">VALUES</font></b>).</p>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        A continuaci&oacute;n de la palabra <b><font color="#008000">VALUES</font></b>, 
        <b><font color="#000080">entre par&eacute;ntesis se escriben los valores 
        que queremos a&ntilde;adir</font></b>. Estos valores se tienen que escribir 
        de<b><font color="#000080"> acuerdo al tipo de dato de la columna</font></b> 
        donde se van a insertar (encerrados entre comillas simples ' ' para valores 
        de tipo texto, entre # # para valores de fecha...) <b><font color="#000080">la 
        asignaci&oacute;n de valores se realiza por posici&oacute;n</font></b>, 
        el primer valor lo asigna a la primera columna, el segundo valor a la 
        segunda columna, as&iacute; sucesivamente...</p>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Cuando la tabla tiene una <b><font color="#000080">columna de tipo contador</font></b> 
        (AutoNumber), lo normal es <b><font color="#000080">no asignar valor </font></b>a 
        esa columna para que el sistema le asigne el valor que le toque seg&uacute;n 
        el contador, si por el contrario queremos que la columna tenga un valor 
        concreto, lo indicamos en la lista de valores. </p>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Cuando no se indica <b><font color="#000080">ninguna lista de columnas</font></b> 
        despu&eacute;s del destino, se asume por defecto <b><font color="#000080">todas 
        las columnas de la tabla</font></b>, en este caso, los valores se tienen 
        que especificar en el <b><font color="#000080">mismo orden</font></b> 
        en que aparecen las columnas en la ventana de<b><font color="#000080"> 
        dise&ntilde;o de dicha tabla</font></b>, y se tiene que utilizar el valor 
        <b> <font color="#008000">NULL</font></b> para rellenar las columnas de 
        las cuales no tenemos valores.</p>
      <P class=padding-1>Ejemplo:<br>
        <b><font color="#008000">INSERT INTO empleados VALUES (200, 'Juan L&oacute;pez', 
        30, NULL, 'rep ventas', #06/23/01#, NULL, 350000, 0)</font></b></p>
      <P class=padding-1>Observar en el ejemplo que los valores de tipo texto 
        se encierran entre comillas simples ' ' (tambi&eacute;n se pueden emplear 
        las comillas dobles &quot; &quot;) y que la fecha de contrato se encierra 
        entre almohadillas # # con el formato mes/dia/a&ntilde;o. Como no tenemos 
        valor para los campos oficina y director (a este nuevo empleado todav&iacute;a 
        no se le ha asignado director ni oficina) utilizamos la palabra reservada 
        <b><font color="#008000">NULL</font></b>. Los valores num&eacute;ricos 
        se escriben tal cual, para separar la parte entera de la parte decimal 
        hay que utilizar siempre el punto independientemente de la configuraci&oacute;n 
        que tengamos.</p>
      <P class=padding-1> <b><font color="#000080"><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Cuando indicamos nombres de columnas</font></b>, estos corresponden a 
        nombres de <b><font color="#000080">columna de la tabla</font></b>, pero 
        no tienen por qu&eacute; estar en el <b><font color="#000080">orden </font></b>en 
        que aparecen en la ventana dise&ntilde;o de la tabla, tambi&eacute;n <b> 
        <font color="#000080">se pueden omitir algunas columnas</font></b>, la 
        columnas que no se nombran tendr&aacute;n <b><font color="#000080">por 
        defecto el valor NULL o el valor predeterminado </font></b>indicado en 
        la ventana de dise&ntilde;o de tabla.<br>
      </p>
      <P class=padding-1>El ejemplo anterior se podr&iacute;a escribir de la siguiente 
        forma:<br>
        <br>
        <b><font color="#008000">INSERT INTO empleados (numemp,oficina, nombre, 
        titulo,cuota, contrato, ventas)<br>
        VALUES (200, 30, 'Juan L&oacute;pez', 'rep ventas',350000, #06/23/01#,0) 
        </font></b> </p>
      <P class=padding-1>Observar que ahora hemos variado el orden de los valores 
        y los nombres de columna no siguen el mismo orden que en la tabla origen, 
        no importa, lo importante es poner los valores en el mismo orden que las 
        columnas que enunciamos. Como no enunciamos las columnas oficina y director 
        se rellenar&aacute;n con el valor nulo (porque es el valor que tienen 
        esas columnas como valor predeterminado).</p>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        El utilizar la opci&oacute;n de <b><font color="#000080">poner una lista 
        de columnas</font></b> podr&iacute;a parecer peor ya que se tiene que 
        escribir m&aacute;s pero realmente <b><font color="#000080">tiene ventajas</font></b> 
        sobre todo <b><font color="#000080">cuando la sentencia la vamos a almacenar 
        y reutilizar</font></b>: <br>
        <br>
        <img src="comunes/redBall2-2.gif" width="14" height="14"> la sentencia queda 
        <b> <font color="#000080">m&aacute;s f&aacute;cil de interpretar</font></b> 
        ley&eacute;ndola vemos qu&eacute; valor asignamos a qu&eacute; columna,<br>
        <br>
        <img src="comunes/redBall2-2.gif" width="14" height="14"> de paso nos <b><font color="#000080">aseguramos</font></b> 
        que el valor lo asignamos a la columna que queremos, <br>
        <br>
        <img src="comunes/redBall2-2.gif" width="14" height="14"> <b><font color="#000080">si</font></b> 
        por lo que sea <b><font color="#000080">cambia el orden de las columnas 
        en la tabla</font></b> en el dise&ntilde;o, no pasar&iacute;a nada mientras 
        que de la otra forma intentar&iacute;a asignar los valores a otra columna, 
        esto producir&iacute;a errores de <i>'tipo no corresponde'</i> y lo que 
        es peor podr&iacute;a asignar valores err&oacute;neos sin que nos demos 
        cuenta,<br>
        <br>
        <img src="comunes/redBall2-2.gif" width="14" height="14"> otra ventaja es 
        que <b><font color="#000080">si se a&ntilde;ade una nueva columna a la 
        tabla </font></b>en el dise&ntilde;o, la primera sentencia INSERT dar&iacute;a 
        error ya que el n&uacute;mero de valores no corresponde con el n&uacute;mero 
        de columnas de la tabla, mientras que la segunda <b> <font color="#008000">INSERT</font></b> 
        no dar&iacute;a error y en la nueva columna se insertar&iacute;a el valor 
        predeterminado.</p>
      <P class=padding-1>&nbsp;</p>
      <P class=padding-1><font color="#000080"><b><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Errores que se pueden producir </b></font> cuando se ejecuta la sentencia 
        <b><font color="#008000">INSERT INTO</font></b>:<br>
        <br>
        <img src="comunes/redBall2-2.gif" width="14" height="14"> <b><font color="#000080">Si 
        la tabla de destino tiene clave principal</font></b> y en ese campo intentamos 
        no asignar valor, asignar el valor nulo o un valor que ya existe en la 
        tabla, el motor de base de datos Microsoft Jet no a&ntilde;ade la fila 
        y da un mensaje de error de '<i>infracciones de clave</i>'.<br>
        <br>
        <img src="comunes/redBall2-2.gif" width="14" height="14"> <b><font color="#000080">Si 
        tenemos</font></b> definido <b><font color="#000080">un &iacute;ndice 
        &uacute;nico</font></b> (sin duplicados) e intentamos asignar un valor 
        que ya existe en la tabla tambi&eacute;n devuelve el mismo error.<br>
        <br>
        <img src="comunes/redBall2-2.gif" width="14" height="14"> <b><font color="#000080">Si 
        la tabla est&aacute; relacionada con otra</font></b>, se seguir&aacute;n 
        las <b><font color="#000080">reglas de integridad referencial</font></b>. 
        Aqu&iacute; puedes repasar las reglas de integridad referencial.<a name="b1"></a><a href="b_6_1_1.htm"><img src="comunes/ico_menos.gif" width="26" height="20" border="0"></a></p>
      <p>&nbsp;</p>
      </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td> 
      <p class=padding-sin>&nbsp;</p>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td> <div align="center"> 
        <script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="5259272651";
google_page_url = document.location;
google_color_border = "FDE8D0";
google_color_bg = "FFF6EC";
google_color_link = "663300";
google_color_url = "CC0000";
google_color_text = "000000";
//--></script>
        <script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
      </div></td>
  </tr>
</table>

<BR>
<TABLE width="100%" border="0">
  <TR> 
    <TD width="37%">&nbsp;</TD>
     
    <TD width="6%"><A href="t_5_2.htm"><IMG name="image8" src="comunes/flecha_re.gif" width="22" height="22" border="0"></A></TD>
     
    <TD width="6%"><A href="index.htm"><IMG name="image8" src="comunes/flecha_home.gif" width="22" height="22" border="0"></A></TD>
		
    <TD width="6%"><A href="t_6_2.htm"><IMG name="image2" src="comunes/flecha_av.gif" width="22" height="22" border="0"></A></TD>
    <TD width="45%"> 
      <DIV align="right">Pag.6.1</DIV>
    </TD>
  </TR>
</TABLE>
<table width="100%" border="0">
  <tr> 
    <td> 
      <div align="center"><font size="-1">Aviso legal: este curso es gratuito 
        siempre que se visualice desde la p&aacute;gina web de aulaClic. No est&aacute; 
        permitido descargar el curso ni utilizarlo en academias o centros de ense&ntilde;anza 
        privados sin estar conectado a Internet. </font></div>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td> 
      <div align="center"><font size="-1">© aulaClic. Todos los derechos reservados. 
 <a href="http://www.teacherclick.com/" style="text-decoration: none; color: black;" target="_blank">Free Computer tutorials</a> . 
        Prohibida la reproducci&oacute;n por cualquier medio.<br>
        </font><font size="2">Julio-2001.aulaClic.com</font></div>
    </td>
  </tr>
</table>
<p style='text-align:justify'>&nbsp;</p>
<!--  fin td width="770" --------------- fin texto pagina -------------------------------->

    </td>
    <td  valign="top">
	<!--   td width="160" -------------- anuncios lateral derecho ---------------------------------->
<table  border="0">

  <tr> 
    <td valign="bottom" height="700"> 
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel ="2175968397";
google_color_border = "FFF6EC";
google_color_bg = "FFF6EC";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
    </td>
	
  </tr>
  
  <tr> 
    <td height="150">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 125;
google_ad_height = 125;
google_ad_format = "125x125_as_rimg";
google_cpa_choice = "CAAQmImJlAIaCN5uB6wtFhbmKNyMs4MB";
google_ad_channel = "6146562423";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
    </td>
  </tr>

  <tr> 
    <td height="150">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 160;
google_ad_height = 90;
google_ad_format = "160x90_0ads_al";
google_ad_channel ="2175968397";
google_color_border = "FAF1E3";
google_color_bg = "FAF1E3";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>    </td>
  </tr>
</table>

	<!--   td width="160" ----------- fin anuncios lateral derecho -------------------------------------->

 </td>
 </tr>
<!--   table de "980" ----------------------------------------------->
</table>

</body>


<!-- Mirrored from www.aulaclic.es/sql/t_6_1.htm by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 10 Jun 2011 06:48:58 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1"><!-- /Added by HTTrack -->
</html>
