
<html>

<!-- Mirrored from www.aulaclic.es/sql/t_3_2.htm by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 10 Jun 2011 06:49:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1"><!-- /Added by HTTrack -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name="keywords" content="SQL Base datos access access2000 tutorial manual gratis office enseñanza educacion ddl dcl dml">
<LINK REL=STYLESHEET TYPE="text/css" HREF="estilo_sinf_osc.css" TITLE="estilo_sinf_osc">
<title>Tema 3 Las consultas multitabla</title>
<SCRIPT language=JavaScript>
<!--
var previous = "t_3_1.htm";
var next = "t_3_3.htm";
//-->
</SCRIPT>
</head><body>
<script type='text/javascript' src='../js/sqlmenu_osc.js'></script> 
<script type='text/javascript' src='../js/menu8_com.js'></script> 

<table width="900" border="0">
  <tr>
    <td width="144"><a href="http://www.aulaclic.es/index.html"><img src="comunes/logo_ac1_50.gif" alt="P&aacute;gina inicial"  border="0" longdesc="P%e1gina%20inicial.html"></a></td>
    <td width="505">&nbsp;</td>
	    <td width="234">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 234;
google_ad_height = 60;
google_ad_format = "234x60_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "FAF1E3";
google_color_bg = "FAF1E3";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">

</script>
    </td>
        </tr>
</table>

<br />

<!--   table de "980" ----------------------------------------------->

<table  border="0"> 
  <tr> 
<td >  </td>
<td  > </td>
  </tr>
  <tr> 
<td > 
<!--   td width="770" ------------------ texto pagina ------------------------------>
<TABLE width="100%" border="0" cellpadding="0">
  <TR>
    <TD><p class=tit-1 > <font color="#800000"><B>Tema 3. Las consultas multitabla </B> (II) </font></p></TD>
    <td><!-- Search Google -->
        <center>
          <form method="get" action="http://www.google.es/custom" target="google_window">
            <table bgcolor="#ffffff">
              <tr>
                <td nowrap="nowrap" valign="top" align="left" height="32"><a href="http://www.google.com/"> <img src="../../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></a>
                    <input type="text" name="q" size="20" maxlength="255" value="">
                    <input type="submit" name="sa" value="B&uacute;squeda">
                    <input type="hidden" name="client" value="pub-1875034419890743">
                    <input type="hidden" name="forid" value="1">
                    <input type="hidden" name="ie" value="ISO-8859-1">
                    <input type="hidden" name="oe" value="ISO-8859-1">
                    <input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFF6EC;LBGC:FFF6EC;ALC:000000;LC:000000;T:0000FF;GFNT:0000FF;GIMP:0000FF;LH:50;LW:141;L:http://www.aulaclic.es/logo_ac1_50.jpg;S:http://www.aulaclic.es/;FORID:1;">
                    <input type="hidden" name="hl" value="es">
                </td>
              </tr>
            </table>
          </form>
        </center>
      <!-- Search Google -->
    </td>
  </TR>
</TABLE>
<BR>
<TABLE width="65%" border="0">
  <TR> 
    <TD width="50%"> 
      <P class=tit-2 > <FONT color="#800000"><B> El operador UNION</B> </FONT></P>
    </TD>
  </TR>
</TABLE>
<BR>
<TABLE width="100%" border="0" cellpadding="0">
  <TR> 
    <TD class="Normal"> 
      <P class=padding-1>Como ya hemos visto en la p&aacute;gina anterior, el 
        operador <B><FONT color="#000080">UNION</FONT></B> sirve para obtener 
        a partir de dos <B><FONT color="#000080">tablas</FONT></B> con las <B><FONT color="#000080">mismas 
        columnas</FONT></B>, una nueva tabla con las <B><FONT color="#000080">filas</FONT></B> 
        de la <B><FONT color="#000080">primera</FONT></B> <B><FONT color="#000080">y</FONT></B> 
        las <B><FONT color="#000080">filas</FONT></B> de la <B><FONT color="#000080">segunda</FONT></B>.</P>
      <P class=padding-1>La sintaxis es la siguiente:</P>
      <P class=padding-1>&nbsp;</P>
      </TD>
  </TR>
</TABLE>
<TABLE width="100%" border="0" cellpadding="0">
  <TR>
    <TD> 
      <P><IMG src="graficos/tr_union.gif" width="459" height="117"><BR>
      </P>
      </TD>
  </TR>
</TABLE>
<TABLE width="100%" border="0" cellpadding="0">
  <TR> 
    <TD class="Normal" width="49%"> 
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"><FONT color="#000080"><B> 
        Consulta</B></FONT> puede ser un <B><FONT color="#000080">nombre de tabla</FONT></B>, 
        un <B><FONT color="#000080">nombre de consulta</FONT></B> (en estos dos 
        casos el nombre debe estar precedido de la palabra <B><FONT color="#000080">TABLE</FONT></B>), 
        o una <B><FONT color="#000080">sentencia SELECT</FONT></B> completa (en 
        este caso no se puede poner <B><FONT size="-1" color="#008000">TABLE</FONT></B>). 
        La sentencia <FONT color="#008000" size="-1"><B>SELECT</B></FONT> puede 
        ser cualquier sentencia <B><FONT size="-1" color="#008000">SELECT</FONT></B> 
        con la &uacute;nica restricci&oacute;n de que no puede contener la cl&aacute;usula 
        <B> <FONT color="#008000"> <FONT size="-1">ORDER BY</FONT></FONT></B>.</P>
      <P class=padding-1>Despu&eacute;s de la primera consulta viene la palabra 
        <B> <FONT color="#000080">UNION</FONT></B> y a continuaci&oacute;n la 
        segunda consulta. La segunda consulta sigue las mismas reglas que la primera 
        consulta.</P>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Las dos consultas deben tener el <B><FONT color="#000080">mismo n&uacute;mero</FONT></B> 
        de <B><FONT color="#000080">columnas</FONT></B> pero las columnas pueden 
        <B> <FONT color="#000080">llamarse</FONT></B> de <B><FONT color="#000080">diferente</FONT></B> 
        forma y ser de <B><FONT color="#000080">tipos</FONT></B> de datos <B><FONT color="#000080">distintos</FONT></B>.</P>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Las <B> <FONT color="#000080">columnas</FONT></B> del <B><FONT color="#000080">resultado</FONT></B> 
        se <B><FONT color="#000080">llaman</FONT></B> como las de la <B><FONT color="#000080">primera 
        consulta</FONT></B>.</P>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Por <B> <FONT color="#000080">defecto</FONT></B> la uni&oacute;n <B><FONT color="#000080">no 
        incluye filas repetidas</FONT></B>, si alguna fila est&aacute; en las 
        dos tablas, s&oacute;lo aparece una vez en el resultado. </P>
      <P class=padding-1>Si <B><FONT color="#000080">queremos</FONT></B> que aparezcan 
        todas las filas incluso las <B><FONT color="#000080">repeticiones</FONT></B> 
        de <B><FONT color="#000080">filas</FONT></B>, incluimos la palabra <B><FONT color="#000080">ALL</FONT></B> 
        (<I>todo</I> en ingl&eacute;s).</P>
      <P class=padding-1> El empleo de <B><FONT color="#000080">ALL</FONT></B> 
        tienen una <B><FONT color="#000080">ventaja</FONT></B>, la consulta <B><FONT color="#000080">se 
        ejecutar&aacute;</FONT></B> <B><FONT color="#000080">m&aacute;s rapidamente</FONT></B>. 
        Puede que la diferencia no se note con tablas peque&ntilde;as, pero si 
        tenemos tablas con muchos registros (filas) la diferencia puede ser notable.</P>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Se puede <B><FONT color="#000080">unir m&aacute;s</FONT></B> de <B><FONT color="#000080">dos</FONT></B> 
        tablas, para ello despu&eacute;s de la segunda consulta <B><FONT color="#000080">repetimos</FONT></B> 
        la palabra <B><FONT color="#000080">UNION</FONT></B> ... y as&iacute; 
        sucesivamente.</P>
      <P class=padding-1><IMG src="comunes/orangeBall.gif" width="14" height="14"> 
        Tambi&eacute;n podemos indicar que queremos el <B><FONT color="#000080">resultado 
        ordenado</FONT></B> por alg&uacute;n criterio, en este caso se incluye 
        la cl&aacute;usula <B> <FONT color="#000080">ORDER BY</FONT></B> que ya 
        vimos en el tema anterior. La cl&aacute;usula <B><FONT size="-1" color="#008000">ORDER 
        BY</FONT></B> se escribe <B><FONT color="#000080">despu&eacute;s</FONT></B> 
        de la <FONT color="#000080"><B>&uacute;ltima consulta</B></FONT>, al final 
        de la sentencia; para indicar las <B><FONT color="#000080">columnas de 
        ordenaci&oacute;n</FONT></B> podemos utilizar su <B><FONT color="#000080">n&uacute;mero 
        de orden</FONT></B> o el <B><FONT color="#000080">nombre de la columna</FONT></B>, 
        en este &uacute;ltimo caso se deben de utilizar los nombres de columna 
        de la <B><FONT color="#000080">primera consulta</FONT></B> ya que son 
        los que se van a utilizar para nombrar las columnas del resultado. </P>
      <P class=padding-1>&nbsp;</P>
      </TD>
  </TR>
</table>
<table width="100%" border="0">
  <tr>
    <td> 
      <P class=padding-1> Para ilustrar la operaci&oacute;n vamos a realizar el 
        ejercicio visto en la p&aacute;gina anterior, vamos a obtener los c&oacute;digos 
        de los productos que tienen existencias iguales a cero o que aparezcan 
        en pedidos del a&ntilde;o 90.</P>
      <P class=padding-1>&nbsp; </P>
      </td>
  </tr>
</table>
<TABLE width="100%" border="0" cellpadding="0">
  <TR>
    <TD width="31%"> 
      <P class=padding-sin><FONT size="-1" color="#008000"><B>SELECT idfab,idproducto<BR>
        FROM productos<BR>
        WHERE existencias = 0<BR>
        UNION ALL <BR>
        SELECT fab,producto<BR>
        FROM pedidos<BR>
        WHERE year(fechapedido) = 1990<BR>
        ORDER BY idproducto</B></FONT><BR>
      </P>
      &nbsp;</TD>
    <TD width="9%"> 
      <P class=padding-sin>o bien<BR>
      </P></TD>
    <TD width="24%"> 
      <P class=padding-sin><B><FONT size="-1" color="#008000">TABLE [existencias 
        cero]<BR>
        UNION ALL<BR>
        TABLE [pedidos 90]<BR>
        ORDER BY idproducto</FONT></B></P>
    </TD>
	  </TR>
</TABLE>
<TABLE width="100%" border="0" cellpadding="0">
  <TR>
    <TD> 
      <P class=padding-sin>Se ha incluido la cl&aacute;usula <B><FONT size="-1" color="#008000">ALL</FONT></B> 
        porque no nos importa que salgan filas repetidas.</P>
      <P class=padding-sin>Se ha incluido <B><FONT size="-1" color="#008000">ORDER 
        BY</FONT></B> para que el resultado salga ordenado por idproducto, observar 
        que hemos utilizado el nombre de la columna de la primera <B><FONT size="-1" color="#008000">SELECT</FONT></B>, 
        tambi&eacute;n pod&iacute;amos haber puesto <B><FONT size="-1" color="#008000">ORDER 
        BY 2</FONT></B> pero no <B><FONT size="-1" color="#008000">ORDER BY producto</FONT></B> 
        (es el nombre de la columna de la segunda tabla).</P>
      <P class=padding-sin><BR>
        Para el 2&ordm; caso hemos creado una consulta llamada<I> existencias 
        cero</I> con la primera <B><FONT size="-1" color="#008000">SELECT</FONT></B>, 
        y una consulta llamada <I>pedidos 90</I> con la segunda <B><FONT size="-1" color="#008000">SELECT</FONT></B>. 
        Observar que los nombres de las consultas est&aacute;n entre corchetes 
        porque contienen espacios en blanco, y que en este caso hay que utilizar 
        <B> <FONT color="#008000"> <FONT size="-1">TABLE</FONT></FONT></B>.<BR>
      </P>
      <P class=padding-sin>&nbsp;</P>
      </TD>
  </TR>
</TABLE>
<br>
<table width="100%" border="0">
  <tr> 
    <td> <div align="center"> 
        <script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="5259272651";
google_page_url = document.location;
google_color_border = "FDE8D0";
google_color_bg = "FFF6EC";
google_color_link = "663300";
google_color_url = "CC0000";
google_color_text = "000000";
//--></script>
        <script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
      </div></td>
  </tr>
</table>

<BR>
<TABLE width="100%" border="0">
  <TR> 
    <TD width="37%">&nbsp;</TD>
     
    <TD width="6%"><A href="t_3_1.htm"><IMG name="image8" src="comunes/flecha_re.gif" width="22" height="22" border="0"></A></TD>
     
    <TD width="6%"><A href="index.htm"><IMG name="image8" src="comunes/flecha_home.gif" width="22" height="22" border="0"></A></TD>
		
    <TD width="6%"><A href="t_3_3.htm"><IMG name="image2" src="comunes/flecha_av.gif" width="22" height="22" border="0"></A></TD>
    <TD width="45%"> 
      <DIV align="right">Pag. 3.2</DIV>
    </TD>
  </TR>
</TABLE>
<table width="100%" border="0">
  <tr> 
    <td> 
      <div align="center"><font size="-1">Aviso legal: este curso es gratuito 
        siempre que se visualice desde la p&aacute;gina web de aulaClic. No est&aacute; 
        permitido descargar el curso ni utilizarlo en academias o centros de ense&ntilde;anza 
        privados sin estar conectado a Internet. </font></div>
    </td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td> 
      <div align="center"><font size="-1">© aulaClic. Todos los derechos reservados. 
 <a href="http://www.teacherclick.com/" style="text-decoration: none; color: black;" target="_blank">Free Computer tutorials</a> . 
        Prohibida la reproducci&oacute;n por cualquier medio.<br>
        </font><font size="2">Abril-2001.aulaClic.com</font></div>
    </td>
  </tr>
</table>
<p style='text-align:justify'>&nbsp;</p>
<!--  fin td width="770" --------------- fin texto pagina -------------------------------->

    </td>
    <td  valign="top">
	<!--   td width="160" -------------- anuncios lateral derecho ---------------------------------->
<table  border="0">

  <tr> 
    <td valign="bottom" height="700"> 
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel ="2175968397";
google_color_border = "FFF6EC";
google_color_bg = "FFF6EC";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
    </td>
	
  </tr>
  
  <tr> 
    <td height="150">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 125;
google_ad_height = 125;
google_ad_format = "125x125_as_rimg";
google_cpa_choice = "CAAQmImJlAIaCN5uB6wtFhbmKNyMs4MB";
google_ad_channel = "6146562423";
//--></script>
<script type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>
    </td>
  </tr>

  <tr> 
    <td height="150">
<script type="text/javascript"><!--
google_ad_client = "pub-1875034419890743";
google_ad_width = 160;
google_ad_height = 90;
google_ad_format = "160x90_0ads_al";
google_ad_channel ="2175968397";
google_color_border = "FAF1E3";
google_color_bg = "FAF1E3";
google_color_link = "663300";
google_color_text = "000000";
google_color_url = "CC0000";
//--></script>
<script type="text/javascript"
  src="../../pagead2.googlesyndication.com/pagead/show_ads.html">
</script>    </td>
  </tr>
</table>

	<!--   td width="160" ----------- fin anuncios lateral derecho -------------------------------------->

 </td>
 </tr>
<!--   table de "980" ----------------------------------------------->
</table>

</body>


<!-- Mirrored from www.aulaclic.es/sql/t_3_2.htm by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 10 Jun 2011 06:49:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1"><!-- /Added by HTTrack -->
</html>
